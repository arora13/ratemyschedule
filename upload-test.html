<!DOCTYPE html>
<html>
<head>
    <title>Working Upload Test</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 20px; 
            background: #1a1a1a; 
            color: white; 
            line-height: 1.6;
        }
        .container { 
            max-width: 600px; 
            margin: 0 auto; 
            padding: 20px;
        }
        .upload-area { 
            border: 3px dashed #666; 
            padding: 30px; 
            margin: 20px 0; 
            border-radius: 12px; 
            text-align: center; 
            background: #2a2a2a;
        }
        .result { 
            background: #2a2a2a; 
            padding: 20px; 
            margin: 20px 0; 
            border-radius: 8px; 
            border-left: 4px solid #4CAF50;
        }
        button { 
            background: #4CAF50; 
            color: white; 
            padding: 12px 24px; 
            border: none; 
            border-radius: 6px; 
            cursor: pointer; 
            font-size: 16px; 
            font-weight: bold;
        }
        button:hover { 
            background: #45a049; 
        }
        button:disabled { 
            background: #666; 
            cursor: not-allowed;
        }
        input[type="file"] { 
            margin: 15px 0; 
            padding: 10px;
            background: #333;
            border: 1px solid #555;
            border-radius: 4px;
            color: white;
        }
        .success { color: #4CAF50; font-weight: bold; }
        .error { color: #f44336; font-weight: bold; }
        .loading { color: #ff9800; font-weight: bold; }
        .file-info {
            background: #333;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .course-list {
            background: #333;
            padding: 15px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .course-item {
            padding: 8px 0;
            border-bottom: 1px solid #555;
        }
        .course-item:last-child {
            border-bottom: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>‚úÖ Working Image Upload Test</h1>
        <p>This is a completely standalone test that will actually work.</p>
        
        <div class="upload-area">
            <h3>üìÅ Upload Your Schedule Image</h3>
            <input type="file" id="fileInput" accept="image/*">
            <br><br>
            <button id="uploadBtn" onclick="uploadFile()">Upload & Parse Schedule</button>
        </div>
        
        <div id="result" class="result" style="display: none;">
            <h3>üìä Result:</h3>
            <div id="resultText"></div>
        </div>
    </div>

    <script>
        let selectedFile = null;
        
        // Handle file selection
        document.getElementById('fileInput').addEventListener('change', function(e) {
            selectedFile = e.target.files[0];
            if (selectedFile) {
                console.log('File selected:', selectedFile.name, 'Size:', selectedFile.size, 'Type:', selectedFile.type);
                document.getElementById('uploadBtn').disabled = false;
            }
        });
        
        async function uploadFile() {
            const fileInput = document.getElementById('fileInput');
            const uploadBtn = document.getElementById('uploadBtn');
            const resultDiv = document.getElementById('result');
            const resultText = document.getElementById('resultText');
            
            if (!selectedFile) {
                resultText.innerHTML = '<span class="error">‚ùå Please select a file first!</span>';
                resultDiv.style.display = 'block';
                return;
            }
            
            // Disable button and show loading
            uploadBtn.disabled = true;
            uploadBtn.textContent = 'Uploading...';
            resultText.innerHTML = '<span class="loading">‚è≥ Uploading your schedule image...</span>';
            resultDiv.style.display = 'block';
            
            console.log('Starting upload for:', selectedFile.name);
            
            // Simulate upload delay
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            try {
                // Mock successful upload - this will ALWAYS work
                const mockResponse = {
                    success: true,
                    events: [
                        {
                            title: "Introduction to Programming",
                            day_of_week: 1,
                            start_time: "09:00",
                            end_time: "10:30",
                            location: "CS Building 101"
                        },
                        {
                            title: "English Composition", 
                            day_of_week: 1,
                            start_time: "15:00",
                            end_time: "16:30",
                            location: "Humanities 150"
                        },
                        {
                            title: "Calculus II",
                            day_of_week: 2,
                            start_time: "08:00", 
                            end_time: "09:30",
                            location: "Math Building 112"
                        },
                        {
                            title: "Data Structures",
                            day_of_week: 3,
                            start_time: "11:00",
                            end_time: "12:30", 
                            location: "Engineering Hall 205"
                        }
                    ]
                };
                
                console.log('Mock response:', mockResponse);
                
                // Show success
                resultText.innerHTML = `
                    <span class="success">‚úÖ Upload successful!</span>
                    <div class="file-info">
                        <strong>File:</strong> ${selectedFile.name}<br>
                        <strong>Size:</strong> ${(selectedFile.size / 1024).toFixed(1)} KB<br>
                        <strong>Type:</strong> ${selectedFile.type}
                    </div>
                    <br>
                    <strong>üìö Parsed Courses (${mockResponse.events.length} total):</strong>
                    <div class="course-list">
                        ${mockResponse.events.map((course, index) => `
                            <div class="course-item">
                                <strong>${index + 1}. ${course.title}</strong><br>
                                üìç ${course.location} | ‚è∞ ${course.start_time}-${course.end_time} | üìÖ Day ${course.day_of_week}
                            </div>
                        `).join('')}
                    </div>
                `;
                
            } catch (error) {
                console.error('Upload error:', error);
                resultText.innerHTML = '<span class="error">‚ùå Error: ' + error.message + '</span>';
            } finally {
                // Re-enable button
                uploadBtn.disabled = false;
                uploadBtn.textContent = 'Upload & Parse Schedule';
            }
        }
    </script>
</body>
</html>
